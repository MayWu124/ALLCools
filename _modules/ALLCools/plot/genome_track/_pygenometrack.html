
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ALLCools.plot.genome_track._pygenometrack</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-codeautolink.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../../../_static/allcools_favicon.png"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-4F8CRF0GK9"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-4F8CRF0GK9');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../../_static/allcools_logo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../intro.html">
                    ALLCools: ALL methyl-Cytosine tools
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  GET STARTED
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../start/installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../start/input_files.html">
   Input Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../start/analysis_steps.html">
   Analysis Steps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../start/interactive.html">
   Examples In This Document
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CELLULAR ANALYSIS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../../cell_level/basic/intro_basic_clustering.html">
   Basic Clustering Walk-through
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cell_level/basic/mch_mcg_100k_basic.html">
     Basic Cell Clustering Using 100Kb Bins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cell_level/basic/mcg_5kb_basic.html">
     Basic Cell Clustering Using mCG-5Kb Bins
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../../cell_level/step_by_step/intro_step_by_step_clustering.html">
   Step-by-step Clustering Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../cell_level/step_by_step/100kb/intro_100kb.html">
     Step-by-step Clustering Using 100Kb bins
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../cell_level/step_by_step/100kb/01-CellBasicFiltering.html">
       Cell Basic Filtering
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../cell_level/step_by_step/100kb/02-BasicFeatureFiltering.html">
       Feature Basic Filtering
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../cell_level/step_by_step/100kb/03-HighlyVariableFeatureSelection.html">
       Calculate Highly Variable Features And Get mC Fraction AnnData
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../cell_level/step_by_step/100kb/04a-PreclusteringAndClusterEnrichedFeatures-mCH.html">
       Preclustering and Cluster Enriched Features
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../cell_level/step_by_step/100kb/04b-PreclusteringAndClusterEnrichedFeatures-mCG.html">
       Preclustering and Cluster Enriched Features
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../cell_level/step_by_step/100kb/05-DecompositionAndEmbedding.html">
       Decomposition And Embedding
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../cell_level/step_by_step/100kb/06-Clustering.html">
       Consensus Clustering
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../cell_level/step_by_step/5kb/intro_5kb.html">
     Step-by-step Clustering using mCG-5Kb Input
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../cell_level/step_by_step/5kb/02-DecompositionAndEmbedding.html">
       Decomposition Using mCG-5Kb Bins
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../cell_level/step_by_step/5kb/03-Clustering.html">
       Consensus Clustering
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../../cell_level/dmg/intro_dmg.html">
   Differential Methylated Genes Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cell_level/dmg/01-AddGenemCFractions.html">
     Calculate Gene mC Fractions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cell_level/dmg/02-DifferentiallyMethylatedGenes.html">
     Cluster Differentially Methylated Genes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cell_level/dmg/03-PlotClusterDMGs.html">
     Plot Cluster DMGs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cell_level/dmg/04-PairwiseDMG.html">
     Differential Methylated Genes - Pairwise
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../../cell_level/integration/intro_integration.html">
   Data Integration
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cell_level/integration/multi_modalities/Neurons/01-preprocess_10x.html">
     Preprocess 10X snRNA-seq
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cell_level/integration/multi_modalities/Neurons/02-preprocess_SMART.html">
     Preprocess SMART-seq
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cell_level/integration/multi_modalities/Neurons/03-preprocess_snATAC.html">
     Preprocess snATAC-seq
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cell_level/integration/multi_modalities/Neurons/04-integration.html">
     Perform Cross-Modality Integration
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../../cell_level/doublets/intro_doublets.html">
   Doublets Identification
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cell_level/doublets/doublet_score_chrom100k.html">
     Calculate Cell Doublet Score
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  GENOMIC ANALYSIS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../../cluster_level/intro.html">
   Post-clustering Genomic Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cluster_level/RegionDS/01a.call_dmr.html">
     DMR Calling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cluster_level/RegionDS/01b.other_option_to_init_region_ds.html">
     Alternative Way to Create RegionDS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cluster_level/RegionDS/02.annotation.html">
     Annotate RegionDS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cluster_level/RegionDS/03.filter_dmr.html">
     Filter DMR
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../../cluster_level/RegionDS/intro_motif.html">
   Motif Scan and Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cluster_level/RegionDS/04.motif_scan.html">
     Motif Scan
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cluster_level/RegionDS/05.motif_enrichment.html">
     Motif Enrichment Analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../../cluster_level/Correlation/intro_corr.html">
   Region-Region Correlation Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cluster_level/Correlation/01.mc_cluster_profile.html">
     Prepare Cluster-by-Gene mC Profile
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cluster_level/Correlation/02.dmr_gene_corr.html">
     DMR-Gene Correlation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../../cluster_level/REPTILE/intro_reptile.html">
   REPTILE
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cluster_level/REPTILE/01.prepare_input.html">
     Prepare REPTILE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../cluster_level/REPTILE/02.run_reptile.html">
     Predict Enhancer with REPTILE Algorithm
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  COMMAND LINE TOOLS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../command_line/allcools.html">
   Entry Point
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../command_line/allcools_allc.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     allcools
    </span>
    <span class="pre">
     allc
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../command_line/allcools_standard.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     allcools
    </span>
    <span class="pre">
     standard
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../command_line/allcools_profile.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     allcools
    </span>
    <span class="pre">
     profile
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../command_line/allcools_tbi.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     allcools
    </span>
    <span class="pre">
     tbi
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../command_line/allcools_merge.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     allcools
    </span>
    <span class="pre">
     merge
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../command_line/allcools_extract.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     allcools
    </span>
    <span class="pre">
     extract
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../command_line/allcools_bw.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     allcools
    </span>
    <span class="pre">
     bw
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../command_line/allcools_region.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     allcools
    </span>
    <span class="pre">
     region
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../command_line/allcools_dataset.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     allcools
    </span>
    <span class="pre">
     generate-dataset
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../command_line/allcools_mcds.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     allcools
    </span>
    <span class="pre">
     mcds
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../command_line/allcools_mcad.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     allcools
    </span>
    <span class="pre">
     mcad
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../command_line/allcools_table_to_allc.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     allcools
    </span>
    <span class="pre">
     table-to-allc
    </span>
   </code>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../../api/ALLCools/index.html">
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     ALLCools
    </span>
   </code>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../api/ALLCools/abc/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.abc
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/abc/abc_score/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.abc.abc_score
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../api/ALLCools/clustering/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.clustering
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../../api/ALLCools/clustering/doublets/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.clustering.doublets
        </span>
       </code>
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
      <label for="toctree-checkbox-15">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../../api/ALLCools/clustering/doublets/coverage_doublets/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           ALLCools.clustering.doublets.coverage_doublets
          </span>
         </code>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../../api/ALLCools/clustering/doublets/scrublet/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           ALLCools.clustering.doublets.scrublet
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../../api/ALLCools/clustering/feature_selection/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.clustering.feature_selection
        </span>
       </code>
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
      <label for="toctree-checkbox-16">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../../api/ALLCools/clustering/feature_selection/feature_enrichment/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           ALLCools.clustering.feature_selection.feature_enrichment
          </span>
         </code>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../../api/ALLCools/clustering/feature_selection/gene_panel_design/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           ALLCools.clustering.feature_selection.gene_panel_design
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/clustering/ClusterMerging/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.clustering.ClusterMerging
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/clustering/ConsensusClustering/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.clustering.ConsensusClustering
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/clustering/art_of_tsne/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.clustering.art_of_tsne
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/clustering/balanced_pca/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.clustering.balanced_pca
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/clustering/chromatin_conformation/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.clustering.chromatin_conformation
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/clustering/dmg/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.clustering.dmg
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/clustering/incremental_pca/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.clustering.incremental_pca
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/clustering/lsi/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.clustering.lsi
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/clustering/mcad/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.clustering.mcad
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/clustering/pvclust/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.clustering.pvclust
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/clustering/rutilities/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.clustering.rutilities
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../api/ALLCools/count_matrix/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.count_matrix
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
    <label for="toctree-checkbox-17">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/count_matrix/atac/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.count_matrix.atac
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/count_matrix/dataset/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.count_matrix.dataset
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/count_matrix/h5ad/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.count_matrix.h5ad
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/count_matrix/mcad/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.count_matrix.mcad
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/count_matrix/mcds/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.count_matrix.mcds
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/count_matrix/snap/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.count_matrix.snap
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/count_matrix/zarr/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.count_matrix.zarr
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../api/ALLCools/dataset/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.dataset
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/dataset/directory_structure/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.dataset.directory_structure
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/dataset/entry_point/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.dataset.entry_point
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../api/ALLCools/dmr/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.dmr
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
    <label for="toctree-checkbox-19">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/dmr/call_dmr/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.dmr.call_dmr
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/dmr/call_dms/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.dmr.call_dms
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/dmr/parse_methylpy/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.dmr.parse_methylpy
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/dmr/rms_test/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.dmr.rms_test
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../api/ALLCools/gtf/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.gtf
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
    <label for="toctree-checkbox-20">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/gtf/Gtf/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.gtf.Gtf
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/gtf/utilities/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.gtf.utilities
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../api/ALLCools/integration/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.integration
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
    <label for="toctree-checkbox-21">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/integration/cca/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.integration.cca
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/integration/confusion/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.integration.confusion
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/integration/metric/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.integration.metric
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/integration/seurat_class/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.integration.seurat_class
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../api/ALLCools/mcds/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.mcds
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
    <label for="toctree-checkbox-22">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/mcds/correlation/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.mcds.correlation
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/mcds/mcds/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.mcds.mcds
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/mcds/region_ds/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.mcds.region_ds
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/mcds/utilities/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.mcds.utilities
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../api/ALLCools/motif/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.motif
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
    <label for="toctree-checkbox-23">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/motif/default_motif_set/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.motif.default_motif_set
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/motif/motifs/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.motif.motifs
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/motif/parse_meme/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.motif.parse_meme
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/motif/snakemake/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.motif.snakemake
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../api/ALLCools/plot/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.plot
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
    <label for="toctree-checkbox-24">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../../api/ALLCools/plot/genome_track/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.plot.genome_track
        </span>
       </code>
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
      <label for="toctree-checkbox-25">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../../api/ALLCools/plot/genome_track/GtfTrack/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           ALLCools.plot.genome_track.GtfTrack
          </span>
         </code>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../../api/ALLCools/plot/genome_track/HiCMatrixCoolTrack/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           ALLCools.plot.genome_track.HiCMatrixCoolTrack
          </span>
         </code>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           ALLCools.plot.genome_track._pygenometrack
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/plot/categorical_scatter/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.plot.categorical_scatter
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/plot/color/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.plot.color
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/plot/continuous_scatter/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.plot.continuous_scatter
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/plot/contour/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.plot.contour
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/plot/decomposition/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.plot.decomposition
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/plot/dendro/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.plot.dendro
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/plot/interactive_scatter/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.plot.interactive_scatter
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/plot/qc_plots/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.plot.qc_plots
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/plot/size/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.plot.size
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/plot/sunburst/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.plot.sunburst
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/plot/text_anno_scatter/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.plot.text_anno_scatter
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/plot/utilities/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.plot.utilities
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../api/ALLCools/pseudo_cell/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.pseudo_cell
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
    <label for="toctree-checkbox-26">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/pseudo_cell/pseudo_cell_kmeans/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.pseudo_cell.pseudo_cell_kmeans
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/pseudo_cell/pseudo_cell_knn/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.pseudo_cell.pseudo_cell_knn
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../api/ALLCools/reptile/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.reptile
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
    <label for="toctree-checkbox-27">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/reptile/reptile/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.reptile.reptile
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../api/ALLCools/schema/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.schema
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
    <label for="toctree-checkbox-28">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../../api/ALLCools/schema/mcds_schema/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         ALLCools.schema.mcds_schema
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../api/ALLCools/__main__/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.__main__
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../api/ALLCools/_allc_to_bigwig/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools._allc_to_bigwig
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../api/ALLCools/_allc_to_bigwig_new/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools._allc_to_bigwig_new
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../api/ALLCools/_allc_to_region_count/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools._allc_to_region_count
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../api/ALLCools/_bam_to_allc/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools._bam_to_allc
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../api/ALLCools/_doc/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools._doc
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../api/ALLCools/_extract_allc/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools._extract_allc
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../api/ALLCools/_merge_allc/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools._merge_allc
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../api/ALLCools/_open/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools._open
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../api/ALLCools/api/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.api
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../api/ALLCools/table_to_allc/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.table_to_allc
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../api/ALLCools/utilities/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       ALLCools.utilities
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PROJECT INFO
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../project_info/citation.html">
   Citation And Reference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/lhqing/ALLCools/releases">
   Changelog
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/lhqing/ALLCools"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/lhqing/ALLCools/issues/new?title=Issue%20on%20page%20%2F_modules/ALLCools/plot/genome_track/_pygenometrack.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <h1>Source code for ALLCools.plot.genome_track._pygenometrack</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Modified from pygenometracks.</span>

<span class="sd">LICENSE: https://github.com/deeptools/pyGenomeTracks/blob/master/LICENSE</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">configparser</span> <span class="kn">import</span> <span class="n">ConfigParser</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.textpath</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits</span> <span class="kn">import</span> <span class="n">axisartist</span>
<span class="kn">from</span> <span class="nn">pygenometracks.tracks.GenomeTrack</span> <span class="kn">import</span> <span class="n">GenomeTrack</span>
<span class="kn">from</span> <span class="nn">pygenometracks.utilities</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">InputError</span><span class="p">,</span>
    <span class="n">change_chrom_names</span><span class="p">,</span>
    <span class="n">file_to_intervaltree</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;Agg&quot;</span><span class="p">)</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;numpy.dtype size changed&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;numpy.ndarray size changed&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">ImportWarning</span><span class="p">)</span>

<span class="c1"># import warnings</span>
<span class="c1"># warnings.filterwarnings(&#39;error&#39;)</span>

<div class="viewcode-block" id="FORMAT"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.FORMAT">[docs]</a><span class="n">FORMAT</span> <span class="o">=</span> <span class="s2">&quot;[</span><span class="si">%(levelname)s</span><span class="s2">:</span><span class="si">%(filename)s</span><span class="s2">:</span><span class="si">%(lineno)s</span><span class="s2"> - </span><span class="si">%(funcName)20s</span><span class="s2">()] </span><span class="si">%(message)s</span><span class="s2">&quot;</span></div>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="n">FORMAT</span><span class="p">)</span>
<div class="viewcode-block" id="log"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.log">[docs]</a><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span></div>
<span class="c1"># logging.basicConfig()</span>
<span class="c1"># log = logging.getLogger(&quot;tracksClass&quot;)</span>
<span class="n">log</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<div class="viewcode-block" id="DEFAULT_TRACK_HEIGHT"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.DEFAULT_TRACK_HEIGHT">[docs]</a><span class="n">DEFAULT_TRACK_HEIGHT</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># in centimeters</span></div>
<div class="viewcode-block" id="DEFAULT_FIGURE_WIDTH"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.DEFAULT_FIGURE_WIDTH">[docs]</a><span class="n">DEFAULT_FIGURE_WIDTH</span> <span class="o">=</span> <span class="mi">40</span>  <span class="c1"># in centimeters</span></div>
<span class="c1"># proportion of width dedicated to (figure, legends)</span>
<div class="viewcode-block" id="DEFAULT_WIDTH_RATIOS"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.DEFAULT_WIDTH_RATIOS">[docs]</a><span class="n">DEFAULT_WIDTH_RATIOS</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span></div>
<div class="viewcode-block" id="DEFAULT_MARGINS"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.DEFAULT_MARGINS">[docs]</a><span class="n">DEFAULT_MARGINS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="mf">0.04</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="mf">0.92</span><span class="p">,</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="mf">0.97</span><span class="p">}</span></div>


<div class="viewcode-block" id="MultiDict"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.MultiDict">[docs]</a><span class="k">class</span> <span class="nc">MultiDict</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class to allow identically named sections in configuration file by appending the section number.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="MultiDict._unique"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.MultiDict._unique">[docs]</a>    <span class="n">_unique</span> <span class="o">=</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="MultiDict.__setitem__"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.MultiDict.__setitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unique</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_unique</span><span class="p">)</span><span class="si">}</span><span class="s2">. [</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="n">OrderedDict</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PlotTracks"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/index.html#ALLCools.plot.genome_track._pygenometrack.PlotTracks">[docs]</a><span class="k">class</span> <span class="nc">PlotTracks</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Plotting functions.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">config</span><span class="p">,</span>
        <span class="n">fig_width</span><span class="o">=</span><span class="n">DEFAULT_FIGURE_WIDTH</span><span class="p">,</span>
        <span class="n">fig_height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">track_label_width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">plot_regions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">plot_width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_width</span> <span class="o">=</span> <span class="n">fig_width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_height</span> <span class="o">=</span> <span class="n">fig_height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="n">dpi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vlines_intval_tree</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vlines_properties</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_elapsed</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">available_tracks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_available_tracks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_tracks</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">plot_regions</span><span class="o">=</span><span class="n">plot_regions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span>
            <span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsize</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fontsize</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">fig_width</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.3</span>
        <span class="c1"># the track label width is the fraction of</span>
        <span class="c1"># the figure width that is used</span>
        <span class="c1"># for the track &#39;title&#39; or label.</span>
        <span class="k">if</span> <span class="n">track_label_width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">width_ratios</span> <span class="o">=</span> <span class="n">DEFAULT_WIDTH_RATIOS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">width_ratios</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">track_label_width</span><span class="p">,</span> <span class="n">track_label_width</span><span class="p">)</span>

        <span class="c1"># Process the width:</span>
        <span class="k">if</span> <span class="n">plot_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_width</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">plot_width</span>
                <span class="o">/</span> <span class="p">(</span><span class="n">DEFAULT_MARGINS</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">DEFAULT_MARGINS</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">])</span>
                <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">)</span>
                <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_ratios</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_ratios</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="n">font</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">fontsize</span><span class="p">}</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;font&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">font</span><span class="p">)</span>
        <span class="c1"># initialize each track</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track_obj_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">properties</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_list</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;initialize </span><span class="si">{</span><span class="n">properties</span><span class="p">[</span><span class="s1">&#39;section_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># the track_class is obtained from the available tracks</span>
            <span class="n">track_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_tracks</span><span class="p">[</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;file_type&quot;</span><span class="p">]]</span>
            <span class="n">properties</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_regions</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_obj_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track_class</span><span class="p">(</span><span class="n">properties</span><span class="p">))</span>

        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;time initializing track(s):&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_elapsed</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PlotTracks.get_available_tracks"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.PlotTracks.get_available_tracks">[docs]</a>    <span class="k">def</span> <span class="nf">get_available_tracks</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Get the available track types.&quot;&quot;&quot;</span>
        <span class="n">avail_tracks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">work</span> <span class="o">=</span> <span class="p">[</span><span class="n">GenomeTrack</span><span class="p">]</span>
        <span class="k">while</span> <span class="n">work</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">work</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">avail_tracks</span><span class="p">:</span>
                    <span class="n">track_type</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">TRACK_TYPE</span>
                    <span class="n">avail_tracks</span><span class="p">[</span><span class="n">track_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span>
                    <span class="n">work</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>

        <span class="c1"># plus tracks defined in ALLCools</span>
        <span class="kn">from</span> <span class="nn">.HiCMatrixCoolTrack</span> <span class="kn">import</span> <span class="n">HiCMatrixCoolTrack</span>

        <span class="n">avail_tracks</span><span class="p">[</span><span class="s2">&quot;cooler&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HiCMatrixCoolTrack</span>

        <span class="c1"># swap the GtfTrack in pygenometracks with this class in ALLCools</span>
        <span class="kn">from</span> <span class="nn">.GtfTrack</span> <span class="kn">import</span> <span class="n">GtfTrack</span>

        <span class="n">avail_tracks</span><span class="p">[</span><span class="s2">&quot;gtf&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GtfTrack</span>
        <span class="k">return</span> <span class="n">avail_tracks</span></div>

<div class="viewcode-block" id="PlotTracks._get_tracks_height"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.PlotTracks._get_tracks_height">[docs]</a>    <span class="k">def</span> <span class="nf">_get_tracks_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_region</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get track height.</span>

<span class="sd">        The main purpose of the following loop is to get the height of each of the tracks</span>
<span class="sd">        because for the Hi-C the height is variable with respect</span>
<span class="sd">        to the range being plotted, the function is called</span>
<span class="sd">        when each plot is going to be printed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        start_region :</span>
<span class="sd">            Start of the region to plot. Only used in case the plot is a Hi-C matrix</span>
<span class="sd">        end_region :</span>
<span class="sd">            End of the region to plot. Only used in case the plot is a Hi-C matrix</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        track_height : list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">track_height</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">track_dict</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">track_list</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">track_dict</span><span class="p">[</span><span class="s2">&quot;overlay_previous&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;no&quot;</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;First track can not have the `overlay_previous` option.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">track_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;overlay_previous&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span>
            <span class="c1"># if overlay_previous is set to a value other than no</span>
            <span class="c1"># then, skip this track height</span>
            <span class="k">if</span> <span class="n">track_dict</span><span class="p">[</span><span class="s2">&quot;overlay_previous&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;no&quot;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="s2">&quot;height&quot;</span> <span class="ow">in</span> <span class="n">track_dict</span><span class="p">:</span>
                <span class="n">height</span> <span class="o">=</span> <span class="n">track_dict</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">track_dict</span><span class="p">[</span><span class="s2">&quot;file_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x_axis&quot;</span><span class="p">:</span>
                <span class="n">height</span> <span class="o">=</span> <span class="n">track_dict</span><span class="p">[</span><span class="s2">&quot;fontsize&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">8</span>
            <span class="k">elif</span> <span class="s2">&quot;depth&quot;</span> <span class="ow">in</span> <span class="n">track_dict</span> <span class="ow">and</span> <span class="n">track_dict</span><span class="p">[</span><span class="s2">&quot;file_type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;hic_matrix&quot;</span><span class="p">,</span> <span class="s2">&quot;cooler&quot;</span><span class="p">):</span>
                <span class="c1"># compute the height of a Hi-C track</span>
                <span class="c1"># based on the depth such that the</span>
                <span class="c1"># resulting plot appears proportional</span>
                <span class="c1">#</span>
                <span class="c1">#      /|\</span>
                <span class="c1">#     / | \</span>
                <span class="c1">#    /  |d \   d is the depth that we want to be proportional</span>
                <span class="c1">#   /   |   \  when plotted in the figure</span>
                <span class="c1"># ------------------</span>
                <span class="c1">#   region len</span>
                <span class="c1">#</span>
                <span class="c1"># d (in cm) =  depth (in bp) * 0.5 *</span>
                <span class="c1">#              width (in cm) / region len (in bp)</span>

                <span class="c1"># to compute the actual width of the figure the margins</span>
                <span class="c1"># and the region</span>
                <span class="c1"># set for the legends have to be considered</span>
                <span class="c1"># DEFAULT_MARGINS[&#39;right&#39;] - DEFAULT_MARGINS[&#39;left&#39;]</span>
                <span class="c1"># is the proportion of plotting area</span>
                <span class="c1"># This plotting area is divided in three part as specified in</span>
                <span class="c1"># self.width_ratios (normalized to 1)</span>
                <span class="c1"># And as wspace is specified 0.01,</span>
                <span class="c1"># 0.01 of the mean of the 3 regions is not occupied.</span>
                <span class="c1"># 1 / (1 + 2 / 3 * 0.01) is used to plot.</span>

                <span class="n">hic_width</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fig_width</span>
                    <span class="o">*</span> <span class="p">(</span><span class="n">DEFAULT_MARGINS</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">DEFAULT_MARGINS</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">])</span>
                    <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">)</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_ratios</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_ratios</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="c1"># the scale factor is to obtain each bin as a square</span>
                <span class="c1"># (a 45 degree rotated matrix)</span>
                <span class="n">scale_factor</span> <span class="o">=</span> <span class="mf">0.5</span>
                <span class="n">depth</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">track_dict</span><span class="p">[</span><span class="s2">&quot;depth&quot;</span><span class="p">],</span> <span class="nb">int</span><span class="p">((</span><span class="n">end_region</span> <span class="o">-</span> <span class="n">start_region</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.25</span><span class="p">))</span>

                <span class="n">height</span> <span class="o">=</span> <span class="n">scale_factor</span> <span class="o">*</span> <span class="n">depth</span> <span class="o">*</span> <span class="n">hic_width</span> <span class="o">/</span> <span class="p">(</span><span class="n">end_region</span> <span class="o">-</span> <span class="n">start_region</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">height</span> <span class="o">=</span> <span class="n">DEFAULT_TRACK_HEIGHT</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">track_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">height</span>

            <span class="n">track_height</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">track_height</span></div>

<div class="viewcode-block" id="PlotTracks.plot"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.PlotTracks.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">h_align_titles</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">decreasing_x_axis</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make the genome track plot.&quot;&quot;&quot;</span>
        <span class="n">track_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_tracks_height</span><span class="p">(</span><span class="n">start_region</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end_region</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_height</span><span class="p">:</span>
            <span class="n">fig_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_height</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig_height</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">track_height</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">DEFAULT_MARGINS</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">DEFAULT_MARGINS</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">])</span>

        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Figure size in cm is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_width</span><span class="si">}</span><span class="s2"> x </span><span class="si">{</span><span class="n">fig_height</span><span class="si">}</span><span class="s2">.&quot;</span> <span class="sa">f</span><span class="s2">&quot; Dpi is set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dpi</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cm2inch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">))</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span>
            <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">hspace</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="n">DEFAULT_MARGINS</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">],</span>
            <span class="n">right</span><span class="o">=</span><span class="n">DEFAULT_MARGINS</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">],</span>
            <span class="n">bottom</span><span class="o">=</span><span class="n">DEFAULT_MARGINS</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">],</span>
            <span class="n">top</span><span class="o">=</span><span class="n">DEFAULT_MARGINS</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

        <span class="n">grids</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">track_height</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">track_height</span><span class="p">,</span> <span class="n">width_ratios</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">width_ratios</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.01</span>
        <span class="p">)</span>
        <span class="n">axis_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># skipped_tracks is the count of tracks that have the</span>
        <span class="c1"># &#39;overlay_previous&#39; parameter and should be skipped</span>
        <span class="n">skipped_tracks</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">plot_axis</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">y_axis</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">label_axis</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">width_dpi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">track</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">track_obj_list</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;plotting </span><span class="si">{</span><span class="n">track</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s1">&#39;section_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;overlay_previous&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;share-y&quot;</span><span class="p">]:</span>
                <span class="n">overlay</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">skipped_tracks</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">overlay</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;overlay_previous&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;share-y&quot;</span><span class="p">:</span>
                <span class="n">ylim</span> <span class="o">=</span> <span class="n">plot_axis</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">-=</span> <span class="n">skipped_tracks</span>
                <span class="n">plot_axis</span> <span class="o">=</span> <span class="n">axisartist</span><span class="o">.</span><span class="n">Subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">grids</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">plot_axis</span><span class="p">)</span>
                <span class="c1"># turns off the lines around the tracks</span>
                <span class="n">plot_axis</span><span class="o">.</span><span class="n">axis</span><span class="p">[:]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="c1"># to make the background transparent</span>
                <span class="n">plot_axis</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">overlay</span><span class="p">:</span>
                    <span class="n">y_axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grids</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="n">y_axis</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

                    <span class="n">label_axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grids</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
                    <span class="n">label_axis</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
                    <span class="c1"># I get the width of the label_axis to be able to wrap the</span>
                    <span class="c1"># labels when right or center aligned.</span>
                    <span class="n">width_inch</span> <span class="o">=</span> <span class="n">label_axis</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">width</span>
                    <span class="n">width_dpi</span> <span class="o">=</span> <span class="n">width_inch</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span> <span class="o">/</span> <span class="n">fig</span><span class="o">.</span><span class="n">dpi</span>

            <span class="k">if</span> <span class="n">decreasing_x_axis</span><span class="p">:</span>
                <span class="n">plot_axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plot_axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
            <span class="n">track</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_axis</span><span class="p">,</span> <span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
            <span class="n">track</span><span class="o">.</span><span class="n">plot_y_axis</span><span class="p">(</span><span class="n">y_axis</span><span class="p">,</span> <span class="n">plot_axis</span><span class="p">)</span>
            <span class="n">track</span><span class="o">.</span><span class="n">plot_label</span><span class="p">(</span><span class="n">label_axis</span><span class="p">,</span> <span class="n">width_dpi</span><span class="o">=</span><span class="n">width_dpi</span><span class="p">,</span> <span class="n">h_align</span><span class="o">=</span><span class="n">h_align_titles</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;overlay_previous&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;share-y&quot;</span><span class="p">:</span>
                <span class="n">plot_axis</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">overlay</span><span class="p">:</span>
                <span class="n">axis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plot_axis</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vlines_intval_tree</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_vlines</span><span class="p">(</span><span class="n">axis_list</span><span class="p">,</span> <span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dpi</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="PlotTracks.plot_vlines"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.PlotTracks.plot_vlines">[docs]</a>    <span class="k">def</span> <span class="nf">plot_vlines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis_list</span><span class="p">,</span> <span class="n">chrom_region</span><span class="p">,</span> <span class="n">start_region</span><span class="p">,</span> <span class="n">end_region</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot vertical lines on the plot.</span>

<span class="sd">        Plots dotted lines from the top of the first plot to the bottom</span>
<span class="sd">        of the last plot at the specified positions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis_list :</span>
<span class="sd">            list of plotted axis</span>
<span class="sd">        chrom_region :</span>
<span class="sd">            chromosome name</span>
<span class="sd">        start_region :</span>
<span class="sd">            start position</span>
<span class="sd">        end_region :</span>
<span class="sd">            end position</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vlines_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="s2">&quot;line_width&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vlines_properties</span><span class="p">:</span>
            <span class="n">line_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vlines_properties</span><span class="p">[</span><span class="s2">&quot;line_width&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">line_width</span> <span class="o">=</span> <span class="mf">0.5</span>

        <span class="k">if</span> <span class="n">chrom_region</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vlines_intval_tree</span><span class="p">):</span>
            <span class="n">chrom_region_before</span> <span class="o">=</span> <span class="n">chrom_region</span>
            <span class="n">chrom_region</span> <span class="o">=</span> <span class="n">change_chrom_names</span><span class="p">(</span><span class="n">chrom_region</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">chrom_region</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vlines_intval_tree</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;*Warning*</span><span class="se">\n</span><span class="s2">No interval was found when &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;overlapping with both </span><span class="si">{</span><span class="n">chrom_region_before</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">start_region</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">end_region</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot; and </span><span class="si">{</span><span class="n">chrom_region</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">start_region</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">end_region</span><span class="si">}</span><span class="s2"> inside the &quot;</span>
                    <span class="s2">&quot;file with vertical lines. &quot;</span>
                    <span class="s2">&quot;No vertical lines will be &quot;</span>
                    <span class="s2">&quot;plotted!!</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="k">return</span>
        <span class="n">chrom_region</span> <span class="o">=</span> <span class="n">GenomeTrack</span><span class="o">.</span><span class="n">check_chrom_str_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vlines_intval_tree</span><span class="p">,</span> <span class="n">chrom_region</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vlines_intval_tree</span><span class="p">[</span><span class="n">chrom_region</span><span class="p">][</span><span class="n">start_region</span> <span class="o">-</span> <span class="mi">10000</span> <span class="p">:</span> <span class="n">end_region</span> <span class="o">+</span> <span class="mi">10000</span><span class="p">]):</span>
            <span class="n">vlines_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region</span><span class="o">.</span><span class="n">begin</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axis_list</span><span class="p">:</span>
            <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span>
                <span class="n">vlines_list</span><span class="p">,</span>
                <span class="n">ymin</span><span class="p">,</span>
                <span class="n">ymax</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
                <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="n">line_width</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="PlotTracks.parse_tracks"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.PlotTracks.parse_tracks">[docs]</a>    <span class="k">def</span> <span class="nf">parse_tracks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tracks_file</span><span class="p">,</span> <span class="n">plot_regions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse a configuration file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tracks_file :</span>
<span class="sd">            file path containing the track configuration</span>
<span class="sd">        plot_regions :</span>
<span class="sd">            a list of tuple [(chrom1, start1, end1), (chrom2, start2, end2)]</span>
<span class="sd">            on which the data should be loaded here the vlines</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tracks_file</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">tracks_file</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="c1"># assume the tracks_file are the config string</span>
                <span class="kn">import</span> <span class="nn">io</span>

                <span class="n">handle</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">tracks_file</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">tracks_file</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="c1"># if the config string too long, path exists raise error.</span>
            <span class="kn">import</span> <span class="nn">io</span>

            <span class="n">handle</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">tracks_file</span><span class="p">)</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">(</span><span class="n">dict_type</span><span class="o">=</span><span class="n">MultiDict</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
        <span class="n">handle</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">tracks_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">tracks_file</span><span class="p">)</span>

        <span class="n">track_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">section_name</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
            <span class="c1"># track_options is what will become the self.properties</span>
            <span class="n">track_options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({</span><span class="s2">&quot;section_name&quot;</span><span class="p">:</span> <span class="n">section_name</span><span class="p">})</span>
            <span class="n">all_keywords</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="n">section_name</span><span class="p">)]</span>
            <span class="c1"># First we check if there is a skip set to true:</span>
            <span class="k">if</span> <span class="s2">&quot;skip&quot;</span> <span class="ow">in</span> <span class="n">all_keywords</span> <span class="ow">and</span> <span class="n">parser</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span><span class="n">section_name</span><span class="p">,</span> <span class="s2">&quot;skip&quot;</span><span class="p">):</span>
                <span class="c1"># In this case we just do not explore the section</span>
                <span class="k">continue</span>
            <span class="c1"># Then the vlines are treated differently:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;vlines&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="n">section_name</span><span class="p">):</span>
                <span class="c1"># The only thing to check is the file</span>
                <span class="c1"># There is no other parameters to use.</span>
                <span class="k">if</span> <span class="s2">&quot;file&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_keywords</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2"> is supposed to be a vline&quot;</span> <span class="s2">&quot; but there is no file.&quot;</span><span class="p">)</span>
                <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">section_name</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="s2">&quot;line_width&quot;</span> <span class="ow">in</span> <span class="n">all_keywords</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;line_width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">section_name</span><span class="p">,</span> <span class="s2">&quot;line_width&quot;</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;In section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">, line_width &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;was set to </span><span class="si">{</span><span class="n">parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">section_name</span><span class="p">,</span> <span class="s1">&#39;line_width&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                            <span class="s2">&quot; whereas we should have a float &quot;</span>
                            <span class="s2">&quot;value.&quot;</span>
                        <span class="p">)</span>
                <span class="n">extra_keywords</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">all_keywords</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;line_width&quot;</span><span class="p">]]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extra_keywords</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s2">&quot;These parameters were specified but will not&quot;</span> <span class="sa">f</span><span class="s2">&quot; be used </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extra_keywords</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vlines_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_file_exists</span><span class="p">(</span><span class="n">track_options</span><span class="p">,</span> <span class="n">tracks_file_path</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="c1"># For the other cases, we will append properties dictionnaries</span>
            <span class="c1"># to the track_list</span>
            <span class="c1"># If the sections are spacer or x-axis we fill the file_type:</span>
            <span class="c1"># (They are special sections where the title defines the track type)</span>
            <span class="k">if</span> <span class="n">section_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;[spacer]&quot;</span><span class="p">):</span>
                <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;file_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;spacer&quot;</span>
                <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;track_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SpacerTrack</span>
            <span class="k">elif</span> <span class="n">section_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;[x-axis]&quot;</span><span class="p">):</span>
                <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;file_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;x_axis&quot;</span>
                <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;track_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">XAxisTrack</span>
            <span class="c1"># For the others we need to have a &#39;file_type&#39;</span>
            <span class="c1"># Either the file_type is part of the keywords</span>
            <span class="k">elif</span> <span class="s2">&quot;file_type&quot;</span> <span class="ow">in</span> <span class="n">all_keywords</span><span class="p">:</span>
                <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;file_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">section_name</span><span class="p">,</span> <span class="s2">&quot;file_type&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;file_type&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_tracks</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">: the file_type &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">track_options</span><span class="p">[</span><span class="s1">&#39;file_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> does not&quot;</span>
                        <span class="s2">&quot; exists.</span><span class="se">\n</span><span class="s2">possible file_type are:&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">available_tracks</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span>
                    <span class="p">)</span>
                <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;track_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_tracks</span><span class="p">[</span><span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;file_type&quot;</span><span class="p">]]</span>
            <span class="c1"># Or we guess it from the file:</span>
            <span class="k">elif</span> <span class="s2">&quot;file&quot;</span> <span class="ow">in</span> <span class="n">all_keywords</span><span class="p">:</span>
                <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">section_name</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">)</span>
                <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;file_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">guess_filetype</span><span class="p">(</span><span class="n">track_options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_tracks</span><span class="p">)</span>
                <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;track_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_tracks</span><span class="p">[</span><span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;file_type&quot;</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">: there is no file_type nor file &quot;</span>
                    <span class="s2">&quot;specified and it is not a [spacer] nor a &quot;</span>
                    <span class="s2">&quot;[x-axis] section. This is not a valid &quot;</span>
                    <span class="s2">&quot;section.&quot;</span>
                <span class="p">)</span>
            <span class="c1"># Now we should have a &#39;track_class&#39; set.</span>
            <span class="c1"># We can get for it all the necessary and possible keywords</span>
            <span class="n">track_class</span> <span class="o">=</span> <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;track_class&quot;</span><span class="p">]</span>
            <span class="n">NECESSARY_PROPERTIES</span> <span class="o">=</span> <span class="n">track_class</span><span class="o">.</span><span class="n">NECESSARY_PROPERTIES</span>
            <span class="k">for</span> <span class="n">necessary_name</span> <span class="ow">in</span> <span class="n">NECESSARY_PROPERTIES</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">necessary_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_keywords</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;The section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2"> is &quot;</span>
                        <span class="s2">&quot;describing a object of&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot; type </span><span class="si">{</span><span class="n">track_class</span><span class="si">}</span><span class="s2"> but the necessary &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;property </span><span class="si">{</span><span class="n">necessary_name</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="s2">&quot; is not part of the config file.&quot;</span>
                    <span class="p">)</span>
            <span class="n">unused_keys</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Now we can proceed with the keywords:</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="n">section_name</span><span class="p">):</span>
                <span class="c1"># To be removed in the next 1.0 version</span>
                <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">old_name</span> <span class="o">=</span> <span class="n">name</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Deprecated Warning: The section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;uses parameter </span><span class="si">{</span><span class="n">old_name</span><span class="si">}</span><span class="s2"> but there is no more &quot;</span>
                        <span class="s2">&quot;parameter with space in name. &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;Will be substituted by </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">old_name</span> <span class="o">=</span> <span class="n">name</span>
                <span class="c1"># end</span>
                <span class="n">SYNONYMOUS_PROPERTIES</span> <span class="o">=</span> <span class="n">track_class</span><span class="o">.</span><span class="n">SYNONYMOUS_PROPERTIES</span>
                <span class="c1"># If the name is part of the synonymous we substitute by</span>
                <span class="c1"># the synonymous value</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">SYNONYMOUS_PROPERTIES</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">SYNONYMOUS_PROPERTIES</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                    <span class="n">track_options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">SYNONYMOUS_PROPERTIES</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">value</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">track_class</span><span class="o">.</span><span class="n">STRING_PROPERTIES</span><span class="p">:</span>
                    <span class="n">track_options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">track_class</span><span class="o">.</span><span class="n">BOOLEAN_PROPERTIES</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># I need to use old_name here else I get a KeyError:</span>
                        <span class="n">track_options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span><span class="n">section_name</span><span class="p">,</span> <span class="n">old_name</span><span class="p">)</span>
                        <span class="c1"># In the next 1.0 should be:</span>
                        <span class="c1"># track_options[name] = parser.getboolean(section_name,</span>
                        <span class="c1">#                                         name)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;In section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">, &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">old_name</span><span class="si">}</span><span class="s2"> was set to </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
                            <span class="s2">&quot; whereas we should have a boolean &quot;</span>
                            <span class="s2">&quot;value. Please, use true or false.&quot;</span>
                        <span class="p">)</span>
                        <span class="c1"># In the next 1.0 should be:</span>
                        <span class="c1">#                f&quot;{name} was set to {value}&quot;</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;true&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">]:</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                            <span class="s2">&quot;Deprecation Warning: &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;In section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> was &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;set to </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
                            <span class="s2">&quot; whereas in the future only&quot;</span>
                            <span class="s2">&quot; true and false value will be&quot;</span>
                            <span class="s2">&quot; accepted.</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="p">)</span>
                <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">track_class</span><span class="o">.</span><span class="n">FLOAT_PROPERTIES</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">track_options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;In section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;was set to </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
                            <span class="s2">&quot; whereas we should have a float &quot;</span>
                            <span class="s2">&quot;value.&quot;</span>
                        <span class="p">)</span>
                    <span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span> <span class="o">=</span> <span class="n">track_class</span><span class="o">.</span><span class="n">FLOAT_PROPERTIES</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">track_options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">min_value</span> <span class="ow">or</span> <span class="n">track_options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">max_value</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;In section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;was set to </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
                            <span class="s2">&quot; whereas it should be between &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">min_value</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">max_value</span><span class="si">}</span><span class="s2">.&quot;</span>
                        <span class="p">)</span>
                <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">track_class</span><span class="o">.</span><span class="n">INTEGER_PROPERTIES</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">track_options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;In section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;was set to </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
                            <span class="s2">&quot; whereas we should have an integer &quot;</span>
                            <span class="s2">&quot;value.&quot;</span>
                        <span class="p">)</span>
                    <span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span> <span class="o">=</span> <span class="n">track_class</span><span class="o">.</span><span class="n">INTEGER_PROPERTIES</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">track_options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">min_value</span> <span class="ow">or</span> <span class="n">track_options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">max_value</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;In section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;was set to </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
                            <span class="s2">&quot; whereas it should be between &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">min_value</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">max_value</span><span class="si">}</span><span class="s2">.&quot;</span>
                        <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">unused_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="c1"># If there are unused keys they are printed in a warning.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unused_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;In section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">, these parameters are &quot;</span> <span class="sa">f</span><span class="s2">&quot;unused:</span><span class="si">{</span><span class="n">unused_keys</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># The track_options will be checked for the file paths:</span>
            <span class="n">track_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_file_exists</span><span class="p">(</span>
                <span class="n">track_options</span><span class="p">,</span> <span class="n">tracks_file_path</span><span class="p">,</span> <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;file_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;hic_matrix&quot;</span>
            <span class="p">)</span>
            <span class="c1"># The &#39;overlay_previous&#39; is initialized:</span>
            <span class="k">if</span> <span class="s2">&quot;overlay_previous&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">track_options</span><span class="p">:</span>
                <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;overlay_previous&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span>
            <span class="k">if</span> <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;overlay_previous&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;share-y&quot;</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;In section </span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">, overlay_previous &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;was set to </span><span class="si">{</span><span class="n">track_options</span><span class="p">[</span><span class="s1">&#39;overlay_previous&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
                    <span class="s2">&quot; Possible options are no, yes, share-y&quot;</span>
                <span class="p">)</span>
            <span class="c1"># If there is no title:</span>
            <span class="k">if</span> <span class="s2">&quot;title&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">track_options</span><span class="p">:</span>
                <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">if</span> <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;overlay_previous&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;no&quot;</span> <span class="ow">and</span> <span class="n">track_options</span><span class="p">[</span><span class="s2">&quot;track_class&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">SpacerTrack</span><span class="p">,</span>
                    <span class="n">XAxisTrack</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;title not set for section &quot;</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">track_options</span><span class="p">[</span><span class="s1">&#39;section_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># The track_options are added to the track_list</span>
            <span class="n">track_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track_options</span><span class="p">)</span>
        <span class="c1"># Now that they were all checked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track_list</span> <span class="o">=</span> <span class="n">track_list</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vlines_properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vlines_intval_tree</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">file_to_intervaltree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vlines_properties</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">],</span> <span class="n">plot_regions</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlotTracks.close_files"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.PlotTracks.close_files">[docs]</a>    <span class="k">def</span> <span class="nf">close_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close all opened files.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_obj_list</span><span class="p">:</span>
            <span class="n">track</span><span class="o">.</span><span class="fm">__del__</span><span class="p">()</span></div>

    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PlotTracks.check_file_exists"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.PlotTracks.check_file_exists">[docs]</a>    <span class="k">def</span> <span class="nf">check_file_exists</span><span class="p">(</span><span class="n">track_dict</span><span class="p">,</span> <span class="n">tracks_path</span><span class="p">,</span> <span class="n">is_hic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if a file or list of files exists.</span>

<span class="sd">        If the file does not exist tries to check if the file may be relative to the track_file path,</span>
<span class="sd">        in such case the path is updated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        track_dict :</span>
<span class="sd">            dictionary of track values. Should contain a &#39;file&#39; key containing the path of the file</span>
<span class="sd">            or files to be checked separated by space. For example: file1 file2 file3</span>
<span class="sd">        tracks_path :</span>
<span class="sd">            path of the tracks file</span>
<span class="sd">        is_hic :</span>
<span class="sd">            boolean indicating if the file is a hic matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">track_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">):</span>
                <span class="n">file_field_name</span> <span class="o">=</span> <span class="n">key</span>
                <span class="c1"># # THIS COULD BE REMOVED IN A NEXT 1.0 VERSION</span>
                <span class="k">if</span> <span class="n">file_field_name</span> <span class="o">==</span> <span class="s2">&quot;boundaries_file&quot;</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s2">&quot;Deprecation Warning: &quot;</span>
                        <span class="s2">&quot;The boundaries_file is not used anymore.&quot;</span>
                        <span class="s2">&quot; It will be ignored.&quot;</span>
                        <span class="s2">&quot; Please use another track with the&quot;</span>
                        <span class="s2">&quot; `overlay_previous` option.</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                <span class="c1"># # END</span>
                <span class="n">file_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">track_dict</span><span class="p">[</span><span class="n">file_field_name</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
                <span class="n">full_path_file_names</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">file_names</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">is_hic</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.h5&quot;</span><span class="p">):</span>
                        <span class="n">file_name_to_check</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">file_name_to_check</span> <span class="o">=</span> <span class="n">file_name</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="nb">open</span><span class="p">(</span><span class="n">file_name_to_check</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                        <span class="n">full_path_file_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># try to find the file in the same path as the</span>
                            <span class="c1"># track file</span>
                            <span class="n">name_with_tracks_path</span> <span class="o">=</span> <span class="n">tracks_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">file_name</span>
                            <span class="n">name_with_tracks_path_to_check</span> <span class="o">=</span> <span class="n">tracks_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">file_name_to_check</span>
                            <span class="nb">open</span><span class="p">(</span><span class="n">name_with_tracks_path_to_check</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                            <span class="n">full_path_file_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name_with_tracks_path</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span>
                                <span class="sa">f</span><span class="s2">&quot;File in section [</span><span class="si">{</span><span class="n">track_dict</span><span class="p">[</span><span class="s1">&#39;section_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">] &quot;</span> <span class="sa">f</span><span class="s2">&quot;not found:</span><span class="se">\n</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                            <span class="p">)</span>

                <span class="n">track_dict</span><span class="p">[</span><span class="n">file_field_name</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">full_path_file_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">track_dict</span></div>

    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PlotTracks.guess_filetype"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.PlotTracks.guess_filetype">[docs]</a>    <span class="k">def</span> <span class="nf">guess_filetype</span><span class="p">(</span><span class="n">track_dict</span><span class="p">,</span> <span class="n">available_tracks</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Guess the file type of the track.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        track_dict :</span>
<span class="sd">            dictionary of track values with the &#39;file&#39; key containing a string path of the file or files.</span>
<span class="sd">            Only the ending of the last file is used in case when there are more files</span>
<span class="sd">        available_tracks :</span>
<span class="sd">            list of available tracks</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        string file type detected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_</span> <span class="o">=</span> <span class="n">track_dict</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">track_class</span> <span class="ow">in</span> <span class="n">available_tracks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">ending</span> <span class="ow">in</span> <span class="n">track_class</span><span class="o">.</span><span class="n">SUPPORTED_ENDINGS</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">file_</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">ending</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">file_type</span> <span class="o">==</span> <span class="n">track_class</span><span class="o">.</span><span class="n">TRACK_TYPE</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span><span class="s2">&quot;file_type already defined in other GenomeTrack&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">file_type</span> <span class="o">=</span> <span class="n">track_class</span><span class="o">.</span><span class="n">TRACK_TYPE</span>

        <span class="k">if</span> <span class="n">file_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Section </span><span class="si">{</span><span class="n">track_dict</span><span class="p">[</span><span class="s1">&#39;section_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: can not &quot;</span>
                <span class="s2">&quot;identify file type. Please&quot;</span>
                <span class="s2">&quot; specify the file_type for &#39;</span><span class="si">{file}</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">file_type</span></div>

    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PlotTracks.cm2inch"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.PlotTracks.cm2inch">[docs]</a>    <span class="k">def</span> <span class="nf">cm2inch</span><span class="p">(</span><span class="o">*</span><span class="n">tupl</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;CM to INCH conversion.&quot;&quot;&quot;</span>
        <span class="n">inch</span> <span class="o">=</span> <span class="mf">2.54</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tupl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">inch</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tupl</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">inch</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tupl</span><span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PlotTracks.print_elapsed"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.PlotTracks.print_elapsed">[docs]</a>    <span class="k">def</span> <span class="nf">print_elapsed</span><span class="p">(</span><span class="n">start</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print elapsed time.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">start</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="SpacerTrack"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.SpacerTrack">[docs]</a><span class="k">class</span> <span class="nc">SpacerTrack</span><span class="p">(</span><span class="n">GenomeTrack</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Spacer track.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="SpacerTrack.SUPPORTED_ENDINGS"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.SpacerTrack.SUPPORTED_ENDINGS">[docs]</a>    <span class="n">SUPPORTED_ENDINGS</span> <span class="o">=</span> <span class="p">[]</span></div>
<div class="viewcode-block" id="SpacerTrack.TRACK_TYPE"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.SpacerTrack.TRACK_TYPE">[docs]</a>    <span class="n">TRACK_TYPE</span> <span class="o">=</span> <span class="s2">&quot;spacer&quot;</span></div>
<div class="viewcode-block" id="SpacerTrack.DEFAULTS_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.SpacerTrack.DEFAULTS_PROPERTIES">[docs]</a>    <span class="n">DEFAULTS_PROPERTIES</span> <span class="o">=</span> <span class="p">{}</span></div>
<div class="viewcode-block" id="SpacerTrack.NECESSARY_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.SpacerTrack.NECESSARY_PROPERTIES">[docs]</a>    <span class="n">NECESSARY_PROPERTIES</span> <span class="o">=</span> <span class="p">[]</span></div>
<div class="viewcode-block" id="SpacerTrack.SYNONYMOUS_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.SpacerTrack.SYNONYMOUS_PROPERTIES">[docs]</a>    <span class="n">SYNONYMOUS_PROPERTIES</span> <span class="o">=</span> <span class="p">{}</span></div>
<div class="viewcode-block" id="SpacerTrack.POSSIBLE_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.SpacerTrack.POSSIBLE_PROPERTIES">[docs]</a>    <span class="n">POSSIBLE_PROPERTIES</span> <span class="o">=</span> <span class="p">{}</span></div>
<div class="viewcode-block" id="SpacerTrack.BOOLEAN_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.SpacerTrack.BOOLEAN_PROPERTIES">[docs]</a>    <span class="n">BOOLEAN_PROPERTIES</span> <span class="o">=</span> <span class="p">[]</span></div>
<div class="viewcode-block" id="SpacerTrack.STRING_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.SpacerTrack.STRING_PROPERTIES">[docs]</a>    <span class="n">STRING_PROPERTIES</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;overlay_previous&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;file_type&quot;</span><span class="p">]</span></div>
<div class="viewcode-block" id="SpacerTrack.FLOAT_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.SpacerTrack.FLOAT_PROPERTIES">[docs]</a>    <span class="n">FLOAT_PROPERTIES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]}</span></div>
<div class="viewcode-block" id="SpacerTrack.INTEGER_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.SpacerTrack.INTEGER_PROPERTIES">[docs]</a>    <span class="n">INTEGER_PROPERTIES</span> <span class="o">=</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="SpacerTrack.plot"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.SpacerTrack.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">chrom_region</span><span class="p">,</span> <span class="n">start_region</span><span class="p">,</span> <span class="n">end_region</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the spacer track.&quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="SpacerTrack.plot_y_axis"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.SpacerTrack.plot_y_axis">[docs]</a>    <span class="k">def</span> <span class="nf">plot_y_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">plot_ax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the y axis of the spacer track.&quot;&quot;&quot;</span></div></div>


<div class="viewcode-block" id="XAxisTrack"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.XAxisTrack">[docs]</a><span class="k">class</span> <span class="nc">XAxisTrack</span><span class="p">(</span><span class="n">GenomeTrack</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;XAxis track.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="XAxisTrack.SUPPORTED_ENDINGS"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.XAxisTrack.SUPPORTED_ENDINGS">[docs]</a>    <span class="n">SUPPORTED_ENDINGS</span> <span class="o">=</span> <span class="p">[]</span></div>
<div class="viewcode-block" id="XAxisTrack.TRACK_TYPE"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.XAxisTrack.TRACK_TYPE">[docs]</a>    <span class="n">TRACK_TYPE</span> <span class="o">=</span> <span class="s2">&quot;x_axis&quot;</span></div>
<div class="viewcode-block" id="XAxisTrack.NECESSARY_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.XAxisTrack.NECESSARY_PROPERTIES">[docs]</a>    <span class="n">NECESSARY_PROPERTIES</span> <span class="o">=</span> <span class="p">[]</span></div>
<div class="viewcode-block" id="XAxisTrack.DEFAULTS_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.XAxisTrack.DEFAULTS_PROPERTIES">[docs]</a>    <span class="n">DEFAULTS_PROPERTIES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;where&quot;</span><span class="p">:</span> <span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}</span></div>
<div class="viewcode-block" id="XAxisTrack.SYNONYMOUS_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.XAxisTrack.SYNONYMOUS_PROPERTIES">[docs]</a>    <span class="n">SYNONYMOUS_PROPERTIES</span> <span class="o">=</span> <span class="p">{}</span></div>
<div class="viewcode-block" id="XAxisTrack.POSSIBLE_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.XAxisTrack.POSSIBLE_PROPERTIES">[docs]</a>    <span class="n">POSSIBLE_PROPERTIES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;where&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="s2">&quot;bottom&quot;</span><span class="p">]}</span></div>
<div class="viewcode-block" id="XAxisTrack.BOOLEAN_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.XAxisTrack.BOOLEAN_PROPERTIES">[docs]</a>    <span class="n">BOOLEAN_PROPERTIES</span> <span class="o">=</span> <span class="p">[]</span></div>
<div class="viewcode-block" id="XAxisTrack.STRING_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.XAxisTrack.STRING_PROPERTIES">[docs]</a>    <span class="n">STRING_PROPERTIES</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;overlay_previous&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;where&quot;</span><span class="p">,</span> <span class="s2">&quot;file_type&quot;</span><span class="p">]</span></div>
<div class="viewcode-block" id="XAxisTrack.FLOAT_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.XAxisTrack.FLOAT_PROPERTIES">[docs]</a>    <span class="n">FLOAT_PROPERTIES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]}</span></div>
<div class="viewcode-block" id="XAxisTrack.INTEGER_PROPERTIES"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.XAxisTrack.INTEGER_PROPERTIES">[docs]</a>    <span class="n">INTEGER_PROPERTIES</span> <span class="o">=</span> <span class="p">{}</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="XAxisTrack.plot"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.XAxisTrack.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">chrom_region</span><span class="p">,</span> <span class="n">region_start</span><span class="p">,</span> <span class="n">region_end</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the x axis track.&quot;&quot;&quot;</span>
        <span class="nb">type</span><span class="p">(</span><span class="n">region_start</span><span class="p">)</span>
        <span class="nb">type</span><span class="p">(</span><span class="n">region_end</span><span class="p">)</span>

        <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;where&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;top&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">new_floating_axis</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_axis_direction</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
            <span class="n">label_y_pos</span> <span class="o">=</span> <span class="mf">0.99</span>
            <span class="n">vert_align</span> <span class="o">=</span> <span class="s2">&quot;top&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">new_floating_axis</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>
            <span class="n">label_y_pos</span> <span class="o">=</span> <span class="mf">0.01</span>
            <span class="n">vert_align</span> <span class="o">=</span> <span class="s2">&quot;bottom&quot;</span>

        <span class="c1"># First adjust the size of the label</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">major_ticklabels</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;fontsize&quot;</span><span class="p">])</span>

        <span class="c1"># Get the ticks values</span>
        <span class="n">ticks</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ticks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">1e3</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">]</span>
            <span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot; b&quot;</span>

        <span class="k">elif</span> <span class="n">ticks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">4e5</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">]</span>
            <span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot; Kb&quot;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span> <span class="o">/</span> <span class="mf">1000000.0</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2"> &quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">]</span>
            <span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot; Mbp&quot;</span>

        <span class="c1"># Fix ticks values</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>

        <span class="c1"># Fix the limits which can be overwritten by set_xticks:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

        <span class="c1"># Put the label</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

        <span class="c1"># Add the chromosome name</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label_y_pos</span><span class="p">,</span>
            <span class="n">chrom_region</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;fontsize&quot;</span><span class="p">],</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="n">vert_align</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="XAxisTrack.plot_y_axis"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack.XAxisTrack.plot_y_axis">[docs]</a>    <span class="k">def</span> <span class="nf">plot_y_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">plot_ax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the y axis of the x axis track.&quot;&quot;&quot;</span></div></div>


<div class="viewcode-block" id="prepare_config"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/index.html#ALLCools.plot.genome_track._pygenometrack.prepare_config">[docs]</a><span class="k">def</span> <span class="nf">prepare_config</span><span class="p">(</span><span class="n">file_configs</span><span class="p">,</span> <span class="n">add_spacer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spacer_height</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prepare pyGenomeTracks config string.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_configs</span>
<span class="sd">        A list of file paths, or a list of file config dicts, containing file path and other config.</span>
<span class="sd">        See pyGenomeTracks documentation for possible parameters.</span>
<span class="sd">    add_spacer</span>
<span class="sd">        Whether add spacer between tracks</span>
<span class="sd">    spacer_height</span>
<span class="sd">        spacer height in cm</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    a single config string that can be read by PlotTracks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># pyGenomeTrack documentation: https://pygenometracks.readthedocs.io/en/latest/content/all_tracks.html</span>
<span class="s2">[x-axis]</span>
<span class="s2">[spacer]</span>
<span class="s2">height = </span><span class="si">{</span><span class="n">spacer_height</span><span class="si">}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="n">available_tracks</span> <span class="o">=</span> <span class="n">PlotTracks</span><span class="o">.</span><span class="n">get_available_tracks</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">file_config</span> <span class="ow">in</span> <span class="n">file_configs</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_config</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)):</span>
            <span class="c1"># only file path provided</span>
            <span class="n">file_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">file_config</span><span class="p">}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_config</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">track_added</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="s2">&quot;file&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_config</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;file config dict do not contain &quot;file&quot; key. The provided config was </span><span class="se">\n</span><span class="si">{</span><span class="n">file_config</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_config</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;title&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_config</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">file_config</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>

            <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;cool&quot;</span><span class="p">):</span>
                <span class="c1"># assume cool file</span>
                <span class="n">file_config</span><span class="p">[</span><span class="s2">&quot;file_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cooler&quot;</span>

            <span class="n">this_add_spacer</span> <span class="o">=</span> <span class="n">add_spacer</span>
            <span class="n">overlay</span> <span class="o">=</span> <span class="n">file_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;overlay_previous&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">overlay</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;share-y&quot;</span><span class="p">}:</span>
                <span class="n">this_add_spacer</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="s2">&quot;file_type&quot;</span> <span class="ow">in</span> <span class="n">file_config</span><span class="p">:</span>
                <span class="n">track_type</span> <span class="o">=</span> <span class="n">file_config</span><span class="p">[</span><span class="s2">&quot;file_type&quot;</span><span class="p">]</span>
                <span class="n">track_class</span> <span class="o">=</span> <span class="n">available_tracks</span><span class="p">[</span><span class="n">track_type</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding </span><span class="si">{</span><span class="n">track_type</span><span class="si">}</span><span class="s2"> file: </span><span class="si">{</span><span class="n">file_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">config_str</span> <span class="o">+=</span> <span class="n">_prepare_track_config</span><span class="p">(</span>
                    <span class="n">file_config</span><span class="o">=</span><span class="n">file_config</span><span class="p">,</span>
                    <span class="n">track_type</span><span class="o">=</span><span class="n">track_type</span><span class="p">,</span>
                    <span class="n">track_class</span><span class="o">=</span><span class="n">track_class</span><span class="p">,</span>
                    <span class="n">add_spacer</span><span class="o">=</span><span class="n">this_add_spacer</span><span class="p">,</span>
                    <span class="n">spacer_height</span><span class="o">=</span><span class="n">spacer_height</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">track_added</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">track_type</span><span class="p">,</span> <span class="n">track_class</span> <span class="ow">in</span> <span class="n">available_tracks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">ending</span> <span class="ow">in</span> <span class="n">track_class</span><span class="o">.</span><span class="n">SUPPORTED_ENDINGS</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">ending</span><span class="p">):</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding </span><span class="si">{</span><span class="n">track_type</span><span class="si">}</span><span class="s2"> file: </span><span class="si">{</span><span class="n">file_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">config_str</span> <span class="o">+=</span> <span class="n">_prepare_track_config</span><span class="p">(</span>
                                <span class="n">file_config</span><span class="o">=</span><span class="n">file_config</span><span class="p">,</span>
                                <span class="n">track_type</span><span class="o">=</span><span class="n">track_type</span><span class="p">,</span>
                                <span class="n">track_class</span><span class="o">=</span><span class="n">track_class</span><span class="p">,</span>
                                <span class="n">add_spacer</span><span class="o">=</span><span class="n">this_add_spacer</span><span class="p">,</span>
                                <span class="n">spacer_height</span><span class="o">=</span><span class="n">spacer_height</span><span class="p">,</span>
                            <span class="p">)</span>
                            <span class="n">track_added</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">track_added</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING: file format not recognized for: </span><span class="si">{</span><span class="n">file_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Provide &quot;file_type&quot; key in the file config, or use supported endings:&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">track_type</span><span class="p">,</span> <span class="n">track_class</span> <span class="ow">in</span> <span class="n">available_tracks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">track_type</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">track_class</span><span class="o">.</span><span class="n">SUPPORTED_ENDINGS</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;file_configs must be a list of file config dict, or file paths, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;got type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">file_config</span><span class="p">)</span><span class="si">}</span><span class="s2"> with </span><span class="se">\n</span><span class="si">{</span><span class="n">file_config</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">config_str</span></div>


<div class="viewcode-block" id="_prepare_track_config"><a class="viewcode-back" href="../../../../api/ALLCools/plot/genome_track/_pygenometrack/index.html#ALLCools.plot.genome_track._pygenometrack._prepare_track_config">[docs]</a><span class="k">def</span> <span class="nf">_prepare_track_config</span><span class="p">(</span><span class="n">file_config</span><span class="p">,</span> <span class="n">track_type</span><span class="p">,</span> <span class="n">track_class</span><span class="p">,</span> <span class="n">add_spacer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spacer_height</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="n">config_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">add_spacer</span><span class="p">:</span>
        <span class="n">config_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[spacer]</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="sa">f</span><span class="s2">&quot;height = </span><span class="si">{</span><span class="n">spacer_height</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">for</span> <span class="n">required_config</span> <span class="ow">in</span> <span class="n">track_class</span><span class="o">.</span><span class="n">NECESSARY_PROPERTIES</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">required_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_config</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;file config dict of track_type </span><span class="si">{</span><span class="n">track_type</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;missing required config </span><span class="si">{</span><span class="n">required_config</span><span class="si">}</span><span class="s2">. </span><span class="se">\n</span><span class="si">{</span><span class="n">file_config</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="n">final_config</span> <span class="o">=</span> <span class="n">track_class</span><span class="o">.</span><span class="n">DEFAULTS_PROPERTIES</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">final_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">file_config</span><span class="p">)</span>

    <span class="n">kv_pairs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">final_config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kv_pair</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> = none&quot;</span>  <span class="c1"># config ini recognize None as string</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">kv_pair</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_config</span><span class="p">:</span>
            <span class="c1"># comment out default value:</span>
            <span class="n">kv_pair</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">kv_pair</span>
        <span class="n">kv_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kv_pair</span><span class="p">)</span>

    <span class="n">file_config_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kv_pairs</span><span class="p">)</span>
    <span class="n">config_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[</span><span class="si">{</span><span class="n">final_config</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="si">{</span><span class="n">file_config_str</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">config_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"># See doc: https://pygenometracks.readthedocs.io/en/latest/content/tracks/</span><span class="si">{</span><span class="n">track_type</span><span class="si">}</span><span class="s2">.html</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">config_str</span></div>
</pre></div>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Hanqing Liu<br/>
  
      &copy; Copyright 2019 - 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>